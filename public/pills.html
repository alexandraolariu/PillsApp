<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8" />
    <title>ðŸ’ŠPills</title>
    <link rel="stylesheet" href="pills.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/quagga/0.12.1/quagga.min.js"></script>
</head>

<body lang="en" onclick="initAudio()">
    <div class="wrapper">
        <header>

        </header>

        <main>

            <nav
                class="w-full fixed z-50 top-0 flex justify-start space-x-10 items-center bg-zinc-800 px-6 py-3 text-white font-sans">
                <div id="user-info" class="font-semibold" style="display: none;">
                    <p>ðŸ‘¤<span id="user-email"></span></p>
                </div>
                <button id="signout-button" class="hover:text-red-300 font-semibold">Sign Out</button>
                <a href="reports.html" class="hover:text-green-700 font-semibold">Reports</a>
                <a href="anatomicexplorer.html" class="hover:text-green-700 font-semibold">Anatomic Explorer</a>
                <a href="mailto:alexandraolariu2000@gmail.com?subject=Help%20for%20aplication&body=Hi%20Alexandra,%20I%20have%20a%20question..."
                    class="hover:text-green-700 font-semibold">Help</a>
            </nav>

            <div class="container mt-[90px]">
                <div class="page-title">Pharmacy Stock Overview</div>

                <div id="loading-indicator" class="hidden">Loading stock data...</div>
                <div id="error-message" class="hidden"></div>


                <!-- Search Bar -->
                <div class="search-section">
                    <label for="searchPills">Search Pills:</label>
                    <input type="text" id="searchPills"
                        placeholder="Search by name, indications, contraindications or form..." onkeyup="searchPills()">
                </div>

                <!-- Pills Display Area -->
                <div class="pillsDisplayArea">
                    <table id="pills-list-table">
                        <thead>
                            <tr>
                                <th class=" ">Pill Name</th>
                                <th class=" ">Quantity</th>
                                <th class=" ">Expiry Date</th>
                                <th class=" ">Price</th>
                                <th class=" ">Indications</th>
                                <th class=" ">Contraindications</th>
                                <th class=" ">Form</th>
                                <th class=" ">Barcode</th>
                                <th class=" ">Actions</th>
                            </tr>
                        </thead>
                        <tbody id="pills-table-body" class="">
                            <!-- Pills will be dynamically loaded here -->
                        </tbody>
                    </table>
                    <p id="no-pills-message" class="text-center text-gray-500 py-4 hidden">No pills in stock yet. Add
                        some below!</p>
                </div>

                <!-- Basket Section -->
                <div class="basket-section">
                    <h2 class="text-2xl font-semibold text-green-700 mb-4">Basket</h2>
                    <div class="lg:flex lg:gap-12">
                        <div class="lg:w-2/3">
                            <table>
                                <thead>
                                    <tr class="">
                                        <th class="">Item</th>
                                        <th class="">Qty</th>
                                        <th class="">Price</th>
                                        <th class="">Subtotal</th>
                                        <th class="">Actions</th>
                                    </tr>
                                </thead>
                                <tr id="empty-basket-message">
                                    <td colspan="5" class="text-gray-500 py-4 text-center">Basket is empty. Add pills
                                        from
                                        the stock above!</td>
                                </tr>
                                <tbody id="basket-table-body" class="divide-y divide-gray-200">
                                    <!-- Basket items will be loaded here -->
                                    <!-- <tr id="empty-basket-message">
                                <td colspan="5" class="text-gray-500 py-4">Basket is empty. Add pills from
                                    the stock above!</td>
                            </tr> -->
                                </tbody>
                            </table>


                            <div class="flex justify-end mt-6">
                                <button onclick="initAudio(); openScannerModal()"
                                    class="font-bold bg-yellow-600 hover:bg-yellow-700 text-white font-bold py-2 px-4 rounded-lg shadow-md">
                                    Scan Barcode
                                </button>
                            </div>

                        </div>

                        <div class="lg:w-1/3 p-6  rounded-lg shadow-inner">




                            <div
                                class="w-full flex flex-col items-center p-6 border-b lg:border-b-0 lg:border-r border-gray-200 lg:pr-6 bg-gray-50 rounded-lg shadow-inner">

                                <span
                                    class="font-extrabold text-2xl text-gray-700 mb-2 uppercase tracking-wider">Total:</span>
                                <span id="basket-total" class="text-4xl text-blue-700 font-extrabold"> 0.00</span>
                            </div>


                            <div class="text-base flex flex-col w-full ml-auto space-y-4 mb-2 p-2 rounded-lg mt-6">
                                <label
                                    class="w-full inline-flex items-center p-3 rounded-lg bg-gray-50 border border-gray-300 hover:bg-accent-light transition duration-150 cursor-pointer">
                                    <input type="radio" name="paymentMethod" value="Credit Card/ Debit" required
                                        class="form-radio h-5 w-5 text-primary border-gray-300 focus:ring-primary">
                                    <span class="ml-3 text-gray-800 font-medium">ðŸ’³ Credit Card/ Debit</span>
                                </label>
                                <label
                                    class="w-full inline-flex items-center p-3 rounded-lg bg-gray-50 border border-gray-300 hover:bg-accent-light transition duration-150 cursor-pointer">
                                    <input type="radio" name="paymentMethod" value="Cash" required
                                        class="form-radio h-5 w-5 text-primary border-gray-300 focus:ring-primary"
                                        checked>
                                    <span class="ml-3 text-gray-800 font-medium">ðŸ’µ Cash</span>
                                </label>
                            </div>

                            <div class="flex justify-center">
                                <button id="generate-bon-fiscal-btn"
                                    class="w-1/2 bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-6 rounded-lg focus:outline-none focus:shadow-outline transition duration-150 ease-in-out shadow-md"
                                    disabled>
                                    Generate Receipt
                                </button>
                            </div>



                        </div>
                    </div>
                </div>

                <!-- Modal Scanner -->
                <div id="scanner-modal"
                    class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
                    <div class="bg-white rounded-lg shadow-lg p-6 w-full max-w-md relative">
                        <button onclick="closeScannerModal()"
                            class="absolute top-2 right-2 text-gray-500 hover:text-red-600 text-xl">&times;</button>
                        <h2 class="text-lg font-bold mb-4">Scan Pill Barcode</h2>
                        <div id="scanner" class="w-full h-64 bg-gray-200 rounded-md"></div>
                        <div class="absolute inset-0 flex items-center justify-center pointer-events-none">
                            <div class="w-48 h-16 border-4 border-green-500 rounded-md"></div>
                        </div>
                        <p id="scan-status" class="mt-4 text-sm text-gray-600">Align the barcode with the camera</p>
                    </div>
                </div>

                <!-- AI Patient Analysis  -->
                <div class="patient-analysis">
                    <h2 class="text-2xl font-semibold text-green-700 mb-4">AI Patient Consultation Analysis</h2>
                    <div class="grid grid-cols-2 gap-10 mt-6">
                        <form id="ai-analysis" class="flex flex-col space-y-2">
                            <input type="number" id="age" placeholder="Age(years)" class="shadow appearance-none border rounded-lg w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline">
                            <input type="number" id="weight" placeholder="Weight(kg)" class="shadow appearance-none border rounded-lg w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline">
                            <textarea name="" id="symptoms"  placeholder="Symptoms(e.g. high fever, muscle pain, cough)" class="shadow appearance-none border rounded-lg w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"></textarea>
                            <textarea name="" id="allergies"  placeholder="Known Allergies(e.g. Penicilin, Lactose)" class="shadow appearance-none border rounded-lg w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"></textarea>
                            <textarea name="" id="chronic-conditions"  placeholder="Chronic Conditions(e.g Diabetes, HTN, Renal Diseases)" class="shadow appearance-none border rounded-lg w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"></textarea>
                            <textarea name="" id="current-medication"  placeholder="Current Medication(for interactions)" class="shadow appearance-none border rounded-lg w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"></textarea>

                            <select class="shadow border rounded-lg w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline">
                                <option>Pregnancy Select</option>
                                <option value="">Not applicable</option>
                                <option value="">Pregnant</option>
                                <option value="">Lactating</option>
                            </select>
                            <button type="submit" class="mt-6 px-6 py-2 bg-indigo-600 hover:bg-indigo-700 text-white font-bold rounded-lg shadow-md transition duration-200 disabled:opacity-50 disabled:cursor-not-allowed">
                            AI Patient Analysis
                    </button>
                        </form>

                        <div id="analysis-result" class="shadow border border-indigo-500 rounded-lg px-3 py-3 bg-indigo-50 "><h3 class="text-indigo-900 text-xl">Patient Analysis Result</h3></div>
                    </div>

                    
                </div>

                <!-- Add New Pill Form -->
                <div class="addPills-section">
                    <h2 class="text-2xl font-semibold text-green-700 mb-4">Add New Pill</h2>
                    <form id="add-pill-form" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label for="pillName" class="block text-gray-700 text-sm font-bold mb-2">Pill
                                Name:</label>
                            <input type="text" id="pillName"
                                class="shadow appearance-none border rounded-lg w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
                                required>
                        </div>
                        <div>
                            <label for="pillQuantity"
                                class="block text-gray-700 text-sm font-bold mb-2">Quantity:</label>
                            <input type="number" id="pillQuantity"
                                class="shadow appearance-none border rounded-lg w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
                                min="0" required>
                        </div>
                        <div>
                            <label for="pillExpiryDate" class="block text-gray-700 text-sm font-bold mb-2">Expiry
                                Date:</label>
                            <input type="date" id="pillExpiryDate"
                                class="shadow appearance-none border rounded-lg w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
                                required>
                        </div>
                        <div>
                            <label for="pillPrice" class="block text-gray-700 text-sm font-bold mb-2">Price
                                ($):</label>
                            <input type="number" id="pillPrice" step="0.01"
                                class="shadow appearance-none border rounded-lg w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
                                min="0" required>
                        </div>
                        <div>
                            <label for="pillIndications"
                                class="block text-gray-700 text-sm font-bold mb-2">Indications:</label>
                            <input type="text" id="pillIndications"
                                class="shadow appearance-none border rounded-lg w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline">
                        </div>
                        <div>
                            <label for="pillContraindications"
                                class="block text-gray-700 text-sm font-bold mb-2">Contraindications:</label>
                            <input type="text" id="pillContraindications"
                                class="shadow appearance-none border rounded-lg w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline">
                        </div>
                        <div>
                            <label for="pillForm" class="block text-gray-700 text-sm font-bold mb-2">Form (e.g.,
                                Tablet,
                                Syrup):</label>
                            <input type="text" id="pillForm"
                                class="shadow appearance-none border rounded-lg w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline">
                        </div>
                        <div>
                            <label for="pillCodDeBare"
                                class="block text-gray-700 text-sm font-bold mb-2">Barcode:</label>
                            <input type="text" id="pillCodDeBare"
                                class="shadow appearance-none border rounded-lg w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline">
                        </div>
                        <div class="md:col-span-2 text-right">
                            <button type="submit" id="submit"
                                class=" bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-6 rounded-lg focus:outline-none focus:shadow-outline transition duration-150 ease-in-out shadow-md">Add
                                Pill</button>
                        </div>
                    </form>

                </div>


                <!-- Edit Pill Modal -->
                <div id="edit-pill-modal" class="modal">
                    <div class="modal-content">
                        <span class="close-button" onclick="closeEditModal()">&times;</span>
                        <h2 class="text-2xl font-semibold text-green-600 mb-4">Edit Pill</h2>
                        <form id="edit-pill-form" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <input type="hidden" id="editPillId">
                            <div>
                                <label for="editPillName" class="block text-sm font-bold mb-2">Pill Name:</label>
                                <input type="text" id="editPillName"
                                    class="shadow appearance-none border rounded-lg w-full py-2 px-3 leading-tight focus:outline-none focus:shadow-outline"
                                    required>
                            </div>
                            <div>
                                <label for="editPillQuantity"
                                    class="block text-gray-700 text-sm font-bold mb-2">Quantity:</label>
                                <input type="number" id="editPillQuantity"
                                    class="shadow appearance-none border rounded-lg w-full py-2 px-3 leading-tight focus:outline-none focus:shadow-outline"
                                    min="0" required>
                            </div>
                            <div>
                                <label for="editPillExpiryDate"
                                    class="block text-gray-700 text-sm font-bold mb-2">Expiry Date:</label>
                                <input type="date" id="editPillExpiryDate"
                                    class="shadow appearance-none border rounded-lg w-full py-2 px-3 leading-tight focus:outline-none focus:shadow-outline"
                                    required>
                            </div>
                            <div>
                                <label for="editPillPrice" class="block text-gray-700 text-sm font-bold mb-2">Price
                                    ($):</label>
                                <input type="number" id="editPillPrice" step="0.01"
                                    class="shadow appearance-none border rounded-lg w-full py-2 px-3 leading-tight focus:outline-none focus:shadow-outline"
                                    min="0" required>
                            </div>
                            <div>
                                <label for="editPillIndications"
                                    class="block text-gray-700 text-sm font-bold mb-2">Indications:</label>
                                <input type="text" id="editPillIndications"
                                    class="shadow appearance-none border rounded-lg w-full py-2 px-3 leading-tight focus:outline-none focus:shadow-outline">
                            </div>
                            <div>
                                <label for="editPillContraindications"
                                    class="block text-gray-700 text-sm font-bold mb-2">Contraindications:</label>
                                <input type="text" id="editPillContraindications"
                                    class="shadow appearance-none border rounded-lg w-full py-2 px-3 leading-tight focus:outline-none focus:shadow-outline">
                            </div>
                            <div>
                                <label for="editPillForm" class="block text-gray-700 text-sm font-bold mb-2">Form
                                    (e.g.,
                                    Tablet, Syrup):</label>
                                <input type="text" id="editPillForm"
                                    class="shadow appearance-none border rounded-lg w-full py-2 px-3 leading-tight focus:outline-none focus:shadow-outline">
                            </div>
                            <div>
                                <label for="editPillCodDeBare"
                                    class="block text-gray-700 text-sm font-bold mb-2">Barcode:</label>
                                <input type="text" id="editPillCodDeBare"
                                    class="shadow appearance-none border rounded-lg w-full py-2 px-3 leading-tight focus:outline-none focus:shadow-outline">
                            </div>
                            <div class="md:col-span-2 text-right">
                                <button type="submit"
                                    class="bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-6 rounded-lg focus:outline-none focus:shadow-outline transition duration-150 ease-in-out shadow-md">Update
                                    Pill</button>
                            </div>
                        </form>
                    </div>
                </div>


                <!-- Message Box Modal -->
                <div id="message-modal" class="modal">
                    <div class="modal-content text-center">
                        <span class="close-button" onclick="closeMessageModal()">&times;</span>
                        <p id="message-text" class="text-lg font-medium mb-4"></p>
                        <button onclick="closeMessageModal()"
                            class="bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded-lg focus:outline-none focus:shadow-outline transition duration-150 ease-in-out">OK</button>
                    </div>
                </div>

                <!-- Confirmation Modal -->
                <div id="confirm-modal" class="modal">
                    <div class="modal-content text-center">
                        <p id="confirm-text" class="text-lg font-medium mb-6">Are you sure?</p>
                        <div class="flex justify-center space-x-4">
                            <button id="confirm-yes-btn"
                                class="bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-5 rounded-lg focus:outline-none focus:shadow-outline transition duration-150 ease-in-out">Yes</button>
                            <button id="confirm-no-btn"
                                class="bg-gray-400 hover:bg-gray-500 text-white font-bold py-2 px-5 rounded-lg focus:outline-none focus:shadow-outline transition duration-150 ease-in-out">No</button>
                        </div>
                    </div>
                </div>

                <!-- Bon Fiscal Modal -->
                <div id="bon-fiscal-modal" class="modal">
                    <div class="modal-content">
                        <span class="close-button" onclick="closeBonFiscalModal()">&times;</span>
                        <div id="bon-fiscal-content" class="p-4">
                            <!-- Bon fiscal content will be generated here -->
                        </div>
                        <div class="flex justify-end mt-4">
                            <button onclick="printBonFiscal()"
                                class="print-button bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded-lg focus:outline-none focus:shadow-outline transition duration-150 ease-in-out">Print
                                Receipt</button>
                        </div>
                    </div>
                </div>
        </main>

    </div>
    <script type="module" src="pills.js"></script>
</body>

</html>